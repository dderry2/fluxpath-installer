# ============================================
# File: mmu/mmu_sensors.cfg
# Location: ~/printer_data/config/mmu/
#
# Purpose:
#   Sensor handlers + unified error macro.
# ============================================

[gcode_macro MMU_ERROR]
gcode:
  {% set msg = params.MSG|default("Unknown MMU error") %}
  RESPOND PREFIX=MMU MSG="ERROR: {msg}"
  CANCEL_PRINT

[gcode_macro MMU_PREGATE_HIT]
gcode:
  {% set v = printer["gcode_macro MMU_VARS"] %}
  RESPOND PREFIX=MMU MSG="PREGATE: filament detected for lane {{ v.active_lane }}"
  MMU_PRELOAD_FROM_PREGATE

[gcode_macro MMU_RUNOUT]
gcode:
  RESPOND PREFIX=MMU MSG="RUNOUT detected"
  PAUSE
