# ============================================
# File: mmu/mmu_preload.cfg
# Location: ~/printer_data/config/mmu/
#
# Purpose:
#   Preload from pregate into PARK for active lane.
# ============================================

[gcode_macro MMU_PRELOAD_FROM_PREGATE]
gcode:
  {% set v = printer["gcode_macro MMU_VARS"] %}
  RESPOND PREFIX=MMU MSG="PRELOAD: filament detected at pregate, staging for lane {{ v.active_lane }}"

  MMU_MOVE_TO_CUTTER_FROM_PARK
  MMU_MOVE_TO_FILAMENT_SENSOR_EXPECT

  RESPOND PREFIX=MMU MSG="PRELOAD: filament at post-cutter sensor, retracting to park"

  MMU_PARK

  RESPOND PREFIX=MMU MSG="PRELOAD complete, lane {{ v.active_lane }} parked"
